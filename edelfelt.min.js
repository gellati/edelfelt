function mapLinks(e,t,n){var o={};t=Math.floor(t);for(var a=t;t+n-1>a;a++){var l=e[a].name+"-"+e[a+1].name,s=(e[a].id+"-"+e[a+1].id).toString();o[s]={factor:-.8,between:[e[a].id.toString(),e[a+1].id.toString()],tooltip:{content:l},attrs:{"stroke-width":1}}}return o}function mapPlaces(e,t,n){var o={};t=Math.floor(t);for(var a=t;t+n>a;a++)console.log("mP2: "+a+", "+Math.floor(a)+", index: "+t+", steps: "+n),o[e[a].id]={value:10,longitude:e[a]["long"],latitude:e[a].lat,tooltip:{content:e[a].name+", "+e[a].country},size:4,country:e[a].country};return o}function drawMap(e,t){$(".mapcontainer").mapael({map:{name:"world_countries",defaultArea:{attrs:{fill:"#f4f4e8",stroke:"#ced8d0"}},defaultPlot:{text:{attrs:{fill:"#000"},attrsHover:{fill:"#000"}}},zoom:{enabled:!0,maxLevel:20,init:{latitude:55,longitude:25,level:10}}},plots:e,links:t})}console.log("letters "+letters.length),console.log(letters[0]),console.log(letters[1]);for(var i=0;i<letters.length;i++)letters[i].pages.length>1&&console.log(letters[i].pages.length);for(var lettersarray=[],i=0;i<letters.length;i++){var letter={};switch(letter.id=letters[i].id,letter.start=letters[i].date,letter.content=letters[i].pages.length.toString(),letters[i].pages.length){case 1:letter.className="one";break;case 2:letter.className="two";break;case 3:letter.className="three";break;case 4:letter.className="four";break;case 5:letter.className="five";break;case 6:letter.className="six";break;case 7:letter.className="seven";break;case 8:letter.className="eight";break;case 9:letter.className="nine";break;case 10:letter.className="ten";break;case 11:letter.className="eleven";break;case 12:letter.className="twelve";break;case 13:letter.className="thirteen";break;case 14:letter.className="fourteen";break;case 15:letter.className="fifteen";break;case 16:letter.className="sixteen";break;case 17:letter.className="seventeen"}letter.title=letters[i].title+"\n"+letters[i].pages.length.toString()+" sidor\n"+letters[i].date,lettersarray.push(letter)}var container=document.getElementById("letters"),items=new vis.DataSet(lettersarray),options={},timeline=new vis.Timeline(container,items,options),locations2=[];$(function(){console.log("locations "+locations.length),console.log(locations[0]),console.log(locations[1]),console.log(locations[2]);for(var e=0;e<locations.length;e++)if("null"!==$.type(locations[e].lat)&&"null"!==$.type(locations[e]["long"])){var t={};t.lat=locations[e].lat,t["long"]=locations[e]["long"],t.name=locations[e].name,t.id=locations[e].id,t.country=locations[e].country,locations2.push(t)}var n=mapLinks(locations2,0,locations2.length);console.log("function: array, index, steps: "+locations2.length+", 0, "+locations2.length);var o=mapPlaces(locations2,0,locations2.length);drawMap(o,n);var a=document.getElementById("rangeslider"),l=0,s=locations2.length-1;noUiSlider.create(a,{start:[0,locations2.length],step:1,margin:1,connect:!0,direction:"ltr",orientation:"horizontal",behaviour:"tap-drag",range:{min:l,max:s},pips:{mode:"steps",density:10}}),console.log("t2: "+locations2.length),a.noUiSlider.on("update",function(e,t){console.log("update: "+e[t]),0===t&&(l=e[t]),1===t&&(s=e[t]),console.log("t3: "+locations2.length),console.log("slider.noUiSlider: array, index, steps: "+locations2.length+", "+l+", "+(s-l));var a=mapPlaces(locations2,l,s-l+1),r=mapLinks(locations2,l,s-l+1),i=[],c=[];for(var p in r)i.push(p);for(var p in n)c.push(p);console.log("links, old: "+c+", new: "+i);var g=[],d=[];for(var p in a)g.push(p);for(var p in o)d.push(p.toString());console.log("places, old: "+d.length+", new: "+g),console.log(o),console.log(n);var m={animDuration:10,deletedLinks:c,newLinks:r};$(".mapcontainer").trigger("update",[{areas:{},plots:{},links:r},a,d,m]),o=a,n=r});var r=document.getElementById("value-input"),i=document.getElementById("value-span");a.noUiSlider.on("update",function(e,t){t?r.value=e[t]:i.innerHTML=e[t]}),r.addEventListener("change",function(){a.noUiSlider.set([null,this.value])})});for(var personsarray=[],i=0;i<persons.length;i++)if("null"!==$.type(persons[i].birth_year)&&"null"!==$.type(persons[i].death_year)){console.log(persons[i]);var person={};person.id=persons[i].id,person.start=persons[i].birth_year,person.end=persons[i].death_year,person.content=persons[i].name,person.title=persons[i].description+"\n"+person.start+"-"+person.end,personsarray.push(person)}var container=document.getElementById("persons"),items=new vis.DataSet(personsarray),options={},timeline=new vis.Timeline(container,items,options);